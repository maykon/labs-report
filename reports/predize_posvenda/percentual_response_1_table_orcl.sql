SELECT se.name as "Seller", COUNT(TM.ID) AS "Total", COUNT(TMM.ID) AS "Total manual", COUNT(TMP.ID) AS "Total manual Predize", DECODE(COUNT(TM.ID), 0, 0, Round(COUNT(TMP.ID) * 100 / COUNT(TM.ID), 2)) AS "Percentual manual Predize", DECODE(coa.TENANT_ID, NULL, 'Nao', 'Sim') AS "Automática habilitada", COUNT(TMA.ID) AS "Total automática", DECODE(COUNT(TM.ID), 0, 0, Round(COUNT(TMA.ID) * 100 / COUNT(TM.ID), 2)) AS "Percentual automática" FROM CORE_PRD.TICKET T INNER JOIN CORE_PRD.TICKET_MESSAGE TM ON TM.TICKET_ID = T.ID INNER JOIN CHRONUS.SELLER SE ON SE.TENANT_ID = T.TENANT_ID AND SE.STATUS = 'ACTIVE' LEFT OUTER JOIN CORE_PRD.CONFIG_ORGANIZATION_ANSWER COA ON COA.CHANNEL_ACCOUNT = T.CHANNEL_ACCOUNT_ID AND COA.TENANT_ID = T.TENANT_ID AND COA.ANSWER_POS_ORDER = 1 LEFT OUTER JOIN CORE_PRD.TICKET_MESSAGE TMM ON TMM.ID = TM.ID and TMM.TICKET_ID = T.ID AND (TM.AUTOMATIC_REPLY IS NULL OR TM.AUTOMATIC_REPLY=0) LEFT OUTER JOIN CORE_PRD.TICKET_MESSAGE TMP ON TMP.ID = TM.ID AND TMP.TICKET_ID = T.ID AND (TM.AUTOMATIC_REPLY IS NULL OR TM.AUTOMATIC_REPLY=0) AND TMP.USER_ID IS NOT NULL LEFT OUTER JOIN CORE_PRD.TICKET_MESSAGE TMA ON TMA.ID = TM.ID AND TMA.TICKET_ID = T.ID AND TMA.AUTOMATIC_REPLY = 1 WHERE T.TYPE = 'POST_ORDER' AND T.STATUS='CLOSED' AND TM.SELLER = 1 AND TM.START_CHANNEL_DATE IS NOT NULL AND TM.START_CHANNEL_DATE >= (TRUNC(SYSDATE) - 1) GROUP BY SE.NAME, DECODE(COA.TENANT_ID, NULL, 'Nao', 'Sim')